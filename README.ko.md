한국어 | **[English](README.md)**

# ReddiScribe

한국어 사용자를 위한 Reddit 브라우징 + AI 영작 데스크톱 앱. 로컬 Ollama LLM을 사용하며 클라우드 API나 API 키가 필요 없습니다.

## 주요 기능

- **이중 언어 Reddit 브라우징** — 게시글 제목과 본문을 AI가 자동으로 한국어 번역
- **댓글 번역** — 최상위 댓글은 자동 번역, 대댓글은 버튼 클릭으로 개별 번역
- **2단계 작성 파이프라인** — 한국어 입력 → 영어 초안 (Stage 1) → Reddit 어조 다듬기 (Stage 2)
- **리파인 채팅** — Stage 3 채팅 패널에서 AI와 대화하며 번역을 반복 수정
- **듀얼 작성 모드** — 새 글, 댓글, 대댓글을 컨텍스트와 함께 작성
- **브라우저 연동** — 작성 완료 후 Reddit을 바로 열어 붙여넣기
- **완전한 오프라인** — Reddit 데이터 가져온 후에는 인터넷 없이 동작
- **이중 언어 UI** — 한국어 / 영어 인터페이스 전환

## 요구 사항

- Python 3.11 이상
- [Ollama](https://ollama.ai) 설치 및 실행
- Ollama 모델 최소 1개 이상 (아래 모델 설정 참고)

## 빠른 시작

### 설치

```bash
# 저장소 클론
git clone https://github.com/mua-vtuber/ReddiScribe.git
cd ReddiScribe

# 패키지 설치
pip install -e .
```

### 모델 설정

ReddiScribe는 두 가지 모델 역할을 사용하며, 앱의 설정 탭에서 지정합니다:

| 역할 | 용도 | 추천 |
|------|------|------|
| **Logic (1차 모델)** | 제목/댓글 번역, 영어 초안 생성 | 가벼운 모델 추천 (예: `gemma2:9b`, `llama3.1:8b`) |
| **Persona (2차 모델)** | Reddit 어조 다듬기, 리파인 채팅 | 고품질 모델 추천 (예: `llama3.1:70b`, `qwen2.5:32b`) |

```bash
# 예시: 모델 다운로드
ollama pull gemma2:9b
ollama pull llama3.1:70b
```

> **참고:** 고품질 모델일수록 결과는 좋지만 속도가 느려집니다. 본인의 하드웨어에 맞게 조절하세요.
>
> **팁:** 처음 설정할 때는 Stage 2 결과물이 원하는 어조로 나오는지 반드시 확인하세요. AI나 영어에 능숙한 지인, 또는 최소한 기계 번역기를 통해 번역 품질을 검증하는 것을 권장합니다. Reddit에 올리기 전에 의도한 뉘앙스가 제대로 전달되는지 확인하세요.

### 실행

**Windows:**
`run.bat` 더블클릭

**Linux / macOS:**
```bash
python -m src.main
```

## 설정

설정은 `config/settings.yaml`에 저장되며 첫 실행 시 자동 생성됩니다. 대부분의 설정은 앱의 **설정 탭**에서 변경할 수 있습니다.

### 주요 설정

| 항목 | 설명 | 기본값 |
|------|------|--------|
| 언어 | UI 언어 (한국어 / 영어) | ko_KR |
| Logic 모델 | 번역 및 초안 생성 모델 | (설정에서 지정) |
| Persona 모델 | 어조 다듬기 모델 | (설정에서 지정) |
| Persona 프롬프트 | Stage 2 다듬기 커스텀 프롬프트 | (설정에서 편집 가능) |
| Ollama 호스트 | Ollama 서버 주소 | http://localhost:11434 |
| 요청 간격 | Reddit 요청 사이 최소 대기 시간(초) | 6 |
| 서브레딧 목록 | 상단바 (+) 또는 설정 탭에서 관리 | (기본 목록) |

## 사용법

### 읽기 탭
1. 상단바 드롭다운에서 서브레딧 선택 ("+"로 새 서브레딧 추가 가능)
2. 게시글 목록이 한국어 번역된 제목과 함께 표시
3. 게시글 클릭 → AI 한국어 번역된 본문 표시
4. 원문/번역 토글로 전환 가능
5. 스크롤하면 댓글이 자동 번역됨; 대댓글은 개별 번역 버튼
6. "댓글 쓰기" 또는 "대댓글" 클릭 → 컨텍스트와 함께 작성 탭으로 이동

### 쓰기 탭
1. **Stage 1 (초안):** 한국어로 작성 → AI가 영어 초안 생성
2. **Stage 2 (다듬기):** AI가 Reddit에 맞는 자연스러운 어조로 재작성
3. **Stage 3 (리파인 채팅):** AI와 대화하며 번역을 반복 조정
4. **제출:** 브라우저에서 Reddit을 열어 바로 게시/붙여넣기

### 내부 동작
- Ollama 모델이 로컬에서 실행 (데이터가 외부로 나가지 않음)
- Reddit 데이터는 공개 JSON 엔드포인트로 가져옴 (API 키 불필요)
- Reddit 요청 간 최소 6초 간격 유지 (속도 제한 준수)
- 번역 결과는 로컬 SQLite DB에 캐싱

## 문제 해결

**"Ollama 연결 거부"**
- Ollama가 실행 중인지 확인: `ollama serve`
- 설정 또는 `config/settings.yaml`에서 호스트 확인 (기본: `http://localhost:11434`)

**"모델을 찾을 수 없습니다"**
- 모델 다운로드: `ollama pull gemma2:9b`
- 설정 탭에서 모델 이름 지정 (Logic / Persona)

**"Reddit 요청 시간 초과"**
- 설정에서 요청 간격 늘리기
- 인터넷 연결 확인

**게시글이 로드되지 않음 (403 에러)**
- 일부 서브레딧은 비인증 "hot" 정렬을 차단합니다; 앱이 자동으로 "new" 정렬로 전환합니다

**디버그 로그 활성화**
- 설정 또는 `config/settings.yaml`에서 로그 레벨을 DEBUG로 변경

## 테스트

```bash
# 개발 의존성 설치
pip install -e ".[dev]"

# 테스트 실행
pytest tests/ -v
```

## 라이선스

LICENSE 파일을 참고하세요.
